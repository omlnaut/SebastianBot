# When creating a new client, follow these instructions:
- put into clients dir, each client own folder
- data that is read from an external source should always be parsed into a pydantic basemodel
    - extract models that are part of the public interface of the client in a models.py
- create a resolver in cloud/dependencies/clients.py
- create a protocol in sebastian/protocols/ defining the client's public interface
    - protocol can be either a single file (e.g., `reddit.py`) or a directory with `__init__.py` (e.g., `gemini/IClient.py` + `gemini/__init__.py`)
        - use directory structure when protocol needs to be organized with multiple files
        - single file is preferred for simple protocols
    - protocol class should be named I{ClientName} (e.g., IRedditClient)
    - include all public methods from the client
    - protocols should not include any implementation details, only the method signatures and docstrings
        - esp. make sure that all interface-related models are defined in the protocol layer
    - protocols may import from `sebastian.shared.*` for shared types like `Result`
- use dependency injection for things like credentials (usually fetched via pydantic model from azure key vault)
- client public methods should return `Result[T]` for error handling, where T is the success type
    - use `Result.from_item(item=value)` for successful results
    - use `Result.from_item(errors=[...])` for error results
    - this allows callers to handle errors gracefully without exceptions
- when creating client from an investigation, add cells showing the usage of the client
- check if it makes sense to extract private helper methods to make public methods more readable
- if a public method uses private helper methods, extract those helpers to a separate file named after the public method
    - name the file after the public method
    - create a `client` dir that contains the `client.py` and the helper files
        - the `models.py` should be at the "root" of the main client dir, not in this sub-directory
        - "export" the client in the `__init__.py` of the main client dir, so no import adjustments should be needed elsewhere
        - `client.py` should use relative imports to import the helpers
        - "main" method in the helper file should contain barely any logic, just call other private methods in the helper file to improve readability
    - keeps the main client file clean and readable
    - example: `GoogleTaskClient.create_task_with_notes()` uses helpers extracted to `create_task_with_notes.py`
    - bad example: private methods that are (or could be) used by multiple public methods should stay in the main client file. i.e. authentication, token fetching, etc.
    - good example: complex logic in `__init__` (i.e. for authentication) can be extracted to a `_login.py` helper file.
- when clients need to support filtering or transformation callbacks:
    - accept callbacks as optional parameters (e.g., `post_filter: Callable[[T], bool] | None = None`)
    - apply the callback within the client for efficiency
    - this allows service layer to define business logic while keeping client layer reusable
    - example: `RedditClient.get_posts()` accepts `post_filter` to filter posts based on service-specific criteria